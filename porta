#!/bin/bash
#
# helper script to execute porta

case $1 in
  "base")
    docker run \
      --rm \
      -v `which docker`:/usr/bin/docker \
      -v /usr/lib/libapparmor.so.1:/usr/lib/libapparmor.so.1 \
      --net=host \
      -e DOCKER_HOST=$DOCKER_HOST \
         ivotron/porta --action $@ > target.json
    ;;
  "tune")
    docker run \
      --rm \
      --privileged \
      -v /sys/kernel/debug:/sys/kernel/debug \
      -v /usr/src:/usr/src \
      -v /lib/modules:/lib/modules \
      -v `which docker`:/usr/bin/docker \
      -v /usr/lib/libapparmor.so.1:/usr/lib/libapparmor.so.1 \
      --net=host \
      -e DOCKER_HOST=$DOCKER_HOST \
         ivotron/porta --action $@ > parameters.json
    ;;
  *)
    echo "Unknown action '$1'"
    ;;
esac
